**Issue:** Требования к хранилищу:
- Проверять порядковый номер события для каждой сущности (требование согласованности).
- Добавлять несколько событий за раз (требование атомарности).
- Не считывать события в промежуточных состояниях (требование изоляции).
- Защищать от потери записанные события требование устойчивости).
- Создавать слепки данных (snapshots).
- Обеспечивать константную производительность как функцию от размера хранилища. 
- Оптимизировать работу с недавними событиями.

**Decision:**
В качестве хранилища событий использовать Kafka.
Kafka объединяет три ключевые возможности, которые позволяют использовать её для реализации стриминга событий о просмотрах фильмов онлайн-кинотеатра.
 - Публиковать или добавлять новые события в поток и подписываться на события из потока или считывать их.
 - Сохранять потоки событий надёжно и долговечно, как это делают РСУБД.
 - Реагировать на события, как только они происходят либо делать это позже (ретроспективно).

Кандидаты описаны в разделе Notes.

**Notes:**
- РСУБД - недостаток - производительность при большом объёме записываемых 
- MongoDB - не подходит из-за модели согласованности и ограниченной поддержки транзакций. 
- Cassandra - xтобы гарантировать строгую возрастающую последовательность, 
 придётся использовать так называемые легковесные транзакции, 
которые дороги с точки зрения производительности. 
В официальной документации рекомендуется использовать их редко и с умом. 
Поскольку операция добавления событий в хранилище одна из самых частых и нужных в вашей ситуации, 
это значительно снижает привлекательность Cassandra как кандидата.
- EventStore - особенность EventStore в том, что логика обработки событий располагается и исполняется внутри самого EventStore с помощью Javascript. 
Это расходится с пониманием того, что именно должно делать хранилище. Хранилище должно хранить события. 
Логику их обработки лучше вынести в отдельные сервисы-обработчики. 